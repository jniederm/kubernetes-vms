---
- hosts: all
  # tasks are executed under 'vagrant' user
  tasks:
    - name: Install python2-dnf module (ansible dnf plugin dependency)
      shell: dnf install -y python2-dnf
      register: dnf_result
      changed_when: dnf_result.stdout | regex_search('Nothing to do\\.') == None
      become: yes
    - name: Install libselinux-python (ansible lineinfile plugin dependency)
      dnf:
        name: libselinux-python
      become: yes
    - name: Set 'vagrant' user password to 'a'
      user:
        name: vagrant
        # generated by python -c 'import crypt; print crypt.crypt("a", "$6$saltsalt$")'
        password: '$6$saltsalt$8gzUrz5S2/0AfMGfui2LllQQ2fwu.jYnAVGef2XY7gAo0jNFrzHsTq9lMr2ze7QvIJxr4BYOKdgDpx4Va9Atb1'
      become: yes
    - include: usability.yml
    - include: kubernetes.yml